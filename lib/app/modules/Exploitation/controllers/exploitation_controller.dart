import 'package:get/get.dart';
import 'package:radiologiev2/app/data/Services/ServiceCompteRendExploration.dart';
import 'package:radiologiev2/app/data/models/Exploration.dart';
import 'package:radiologiev2/app/data/models/authentification.dart';

class ExploitationController extends GetxController {
  final ServiceCompteRenduExploration serviceCompteRenduExplo =
      ServiceCompteRenduExploration();
  RxList<CompteRenduExploration> listCompteExplo =
      List<CompteRenduExploration>.empty(growable: true).obs;
  RxList<CompteRenduExploration> Patienttrouve = <CompteRenduExploration>[].obs;
  RxBool isLoaded = false.obs;
  RxBool isSearching = false.obs;
  RxString searchInput = "".obs;
  Authentification configuration = Authentification();

  @override
  void onInit() {
    super.onInit();
    fetchCompteRenduExplo();
    isLoaded.value = false;
  }

  fetchCompteRenduExplo() async {
    print("eeeeeeeeeeeee");
    var comptes = await ServiceCompteRenduExploration.fetchCompteRenduExplo();
    if (comptes != null) {
      listCompteExplo.value = comptes;
      Patienttrouve.value = listCompteExplo;
      // ignore: empty_statements
    }
    return listCompteExplo;
  }

  void changeStatus(bool change) {
    isSearching.value = change;
  }

  searchPatient(String input) {
    List<CompteRenduExploration> results = listCompteExplo
        .where((element) => element.patient
            .toString()
            .toLowerCase()
            .contains(input.toLowerCase()))
        .toList();
    Patienttrouve.value = results.obs;
  }
}
